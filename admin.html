<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard</title>
   <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
  <style>
    *{margin:0;padding:0;box-sizing:border-box;font-family:"Segoe UI",sans-serif}
    body{background:#f4f6f9;display:flex;min-height:100vh;color:#333}
    .sidebar{width:240px;background:linear-gradient(180deg,#2575fc,#6a11cb);color:white;padding:25px;display:flex;flex-direction:column;box-shadow:2px 0 12px rgba(0,0,0,0.1)}
    .sidebar h2{margin-bottom:40px;text-align:center;font-size:22px}
    .sidebar a{color:white;text-decoration:none;margin:12px 0;display:flex;align-items:center;padding:10px;border-radius:8px;transition:0.2s;cursor:pointer}
    .sidebar a:hover{background:rgba(255,255,255,0.2)}
    .sidebar a span{margin-left:10px}
    .content{flex:1;padding:30px}
    header{text-align:center;margin-bottom:30px}
    .card{background:white;padding:20px;border-radius:14px;box-shadow:0 4px 18px rgba(0,0,0,0.08);margin-bottom:20px}
    .card h3{margin-bottom:15px;color:#2575fc}
    ul{list-style:none}
    li{margin:10px 0;padding:12px;border:1px solid #eee;border-radius:8px;display:flex;justify-content:space-between;align-items:center}
    button{background:#2575fc;color:white;border:none;padding:8px 14px;border-radius:6px;cursor:pointer;transition:0.2s}
    button:hover{background:#1a5ac8}
    .badge{padding:4px 10px;border-radius:10px;font-size:13px}
    .available{background:#d4fcd4;color:#0b8e0b}
    .busy{background:#fcd4d4;color:#b30000}
    /* Popup */
    .popup{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);
           display:none;justify-content:center;align-items:center}
    .popup-content{background:white;padding:25px;border-radius:12px;width:320px;text-align:center;animation:fadeIn 0.3s}
    .popup h3{margin-bottom:15px;color:#2575fc}
    .popup ul{list-style:none;margin-bottom:15px;text-align:left}
    .popup ul li{margin:8px 0;display:flex;justify-content:space-between;align-items:center}
    @keyframes fadeIn{from{opacity:0;transform:scale(0.9)}to{opacity:1;transform:scale(1)}}
  </style>
</head>
<body>
  <div class="sidebar">
    <h2>Admin</h2>
    <a onclick="switchView('dashboard')">üìä <span>Dashboard</span></a>
    <a onclick="switchView('requests')">üìã <span>Requests</span></a>
    <a onclick="switchView('counselors')">üë©‚Äçüè´ <span>Counselors</span></a>
    <a onclick="switchView('history')">üìú <span>History</span></a>
    <a>üö™ <span>Logout</span></a>
  </div>

  <div class="content">
    <header><h2 id="pageTitle">Dashboard</h2></header>

    <!-- Dashboard -->
    <section id="dashboardView">
      <div class="card">
        <h3>Overview</h3>
        <p>Total Requests: <b id="reqCount">0</b></p>
        <p>Available Counselors: <b id="availCount">0</b></p>
      </div>
    </section>

    <!-- Requests -->
    <section id="requestsView" style="display:none;">
      <div class="card">
        <h3>Student Requests (Oldest First)</h3>
        <ul id="requests"></ul>
      </div>
    </section>

    <!-- Counselors -->
    <section id="counselorsView" style="display:none;">
      <div class="card">
        <h3>Counselors</h3>
        <ul id="counselorList"></ul>
      </div>
    </section>

    <!-- History -->
    <section id="historyView" style="display:none;">
      <div class="card">
        <h3>Visited History</h3>
        <ul id="historyList"></ul>
      </div>
    </section>
  </div>

  <!-- Popup -->
  <div class="popup" id="popup">
    <div class="popup-content">
      <h3>Assign Counselor</h3>
      <p id="selectedStudent"></p>
      <ul id="counselorOptions"></ul>
      <button onclick="closePopup()">Cancel</button>
    </div>
  </div>

  <script>
    let currentStudent="";
    let counselors=[
      {name:"Dr. Mehta",status:"available"},
      {name:"Dr. Sharma",status:"busy"},
      {name:"Dr. Riya",status:"available"}
    ];

    // Preload some requests if empty
    if(!localStorage.getItem("requests")){
      let initial=[
        {name:"Ronak",time:Date.now()-60000},
        {name:"Aryan",time:Date.now()-40000},
        {name:"Kavya",time:Date.now()-20000}
      ];
      localStorage.setItem("requests",JSON.stringify(initial));
    }
    if(!localStorage.getItem("history")) localStorage.setItem("history","[]");

    function switchView(view){
      document.getElementById("dashboardView").style.display="none";
      document.getElementById("requestsView").style.display="none";
      document.getElementById("counselorsView").style.display="none";
      document.getElementById("historyView").style.display="none";
      document.getElementById(view+"View").style.display="block";
      document.getElementById("pageTitle").innerText=view.charAt(0).toUpperCase()+view.slice(1);
      if(view==="requests") renderRequests();
      if(view==="counselors") renderCounselors();
      if(view==="history") renderHistory();
      if(view==="dashboard") updateOverview();
    }

    function renderRequests(){
      let reqs=JSON.parse(localStorage.getItem("requests")||"[]");
      reqs.sort((a,b)=>a.time-b.time); // oldest first
      let container=document.getElementById("requests");
      container.innerHTML="";
      if(reqs.length===0){
        container.innerHTML="<li>No pending requests</li>";
        return;
      }
      reqs.forEach(r=>{
        let li=document.createElement("li");
        li.innerHTML=`<span>${r.name} <small>(${new Date(r.time).toLocaleTimeString()})</small></span>
                      <button onclick="openPopup('${r.name}')">Assign</button>`;
        container.appendChild(li);
      });
      document.getElementById("reqCount").innerText=reqs.length;
    }

    function renderCounselors(){
      let list=document.getElementById("counselorList");
      list.innerHTML="";
      counselors.forEach(c=>{
        let li=document.createElement("li");
        let statusClass=c.status==="available"?"available":"busy";
        li.innerHTML=`${c.name} <span class="badge ${statusClass}">${c.status}</span>`;
        list.appendChild(li);
      });
      let avail=counselors.filter(c=>c.status==="available").length;
      document.getElementById("availCount").innerText=avail;
    }

    function renderHistory(){
      let history=JSON.parse(localStorage.getItem("history")||"[]");
      let list=document.getElementById("historyList");
      list.innerHTML="";
      if(history.length===0){
        list.innerHTML="<li>No history yet</li>";
        return;
      }
      history.forEach(h=>{
        let li=document.createElement("li");
        li.textContent=`${h.student} ‚Üí ${h.counselor} at ${new Date(h.time).toLocaleTimeString()}`;
        list.appendChild(li);
      });
    }

    function openPopup(student){
      currentStudent=student;
      document.getElementById("selectedStudent").innerText="Assigning: "+student;
      let ul=document.getElementById("counselorOptions");
      ul.innerHTML="";
      counselors.forEach(c=>{
        let li=document.createElement("li");
        if(c.status==="available"){
          li.innerHTML=`${c.name} <button onclick="assign('${c.name}')">Select</button>`;
        }else{
          li.innerHTML=`${c.name} <button disabled>Busy</button>`;
        }
        ul.appendChild(li);
      });
      document.getElementById("popup").style.display="flex";
    }

    function closePopup(){
      document.getElementById("popup").style.display="none";
    }

    function assign(counselorName){
      // remove student from requests
      let reqs=JSON.parse(localStorage.getItem("requests")||"[]");
      reqs=reqs.filter(r=>r.name!==currentStudent);
      localStorage.setItem("requests",JSON.stringify(reqs));
      // update counselor status
      counselors=counselors.map(c=>{
        if(c.name===counselorName) return {...c,status:"busy"};
        return c;
      });
      // save history
      let history=JSON.parse(localStorage.getItem("history")||"[]");
      history.unshift({student:currentStudent,counselor:counselorName,time:Date.now()});
      localStorage.setItem("history",JSON.stringify(history));
      closePopup();
      renderRequests();
      renderCounselors();
      renderHistory();
      updateOverview();
      currentStudent="";
    }

    function updateOverview(){
      renderRequests();
      renderCounselors();
    }

    // initial
    switchView("dashboard");
  </script>
  <script>
  <script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyBhd1nA_w_g1DQFI61Cci0AIa7ODy7-mgI",
    authDomain: "sih1-6ed00.firebaseapp.com",
    projectId: "sih1-6ed00",
    storageBucket: "sih1-6ed00.firebasestorage.app",
    messagingSenderId: "503819383394",
    appId: "1:503819383394:web:94ac77058b6b9f9b0f173b"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
</script>
</body>
</html>



